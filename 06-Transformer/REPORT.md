# Генератор текста на базе Transformer

## Описание проекта
Реализован генератор текста на базе декодер-трансформера, обученный на литературных произведениях:
- "The Picture of Dorian Gray"
- "Alice's Adventures in Wonderland"
- "The Adventures of Tom Sawyer"
- "Frankenstein; Or, The Modern Prometheus"
- "The Life and Adventures of Robinson Crusoe"

## Реализованная функциональность

### 1. Архитектура модели
- **Decoder-only трансформер** с параметрами:
  - 8 слоёв
  - 16 голов внимания
  - Размерность модели 1024
  - Размер FFN слоя 4096

### 2. Токенизация
- Реализован BPE-токенизатор с:
  - Специальными токенами (`[PAD]`, `<s>`, `</s>`)
  - Словарём размером 30000 токенов
  - Претокенизацией по пробелам

### 3. Обучение
- Параметры обучения:
  - Batch size: 1
  - Learning rate: 1e-4
  - Context window: 192 токена
  - 3 эпохи обучения

### 4. Генерация текста
Реализованы два режима:
1. **Жадное декодирование** (Greedy)
2. **Beam search** с параметрами:
   - Ширина луча: 5
   - Temperature: 0.3
   - Top-k: 40
   - Top-p: 0.9
   - Штраф за повторения: 2.2

## Примеры работы

### Успешные случаи
You: Write a Gothic-style sentence about a portrait
Bot: The portrait's eyes followed him through the dimly lit room, their gaze as cold as the grave.

### Проблемные области
You: Describe Robinson Crusoe's island
Bot: Robinson looked at the island and... Lord Henry said "My dear boy" while the painter...

## Выявленные проблемы

1. **Контекстуальные утечки**:
   - Персонажи из разных книг появляются в несоответствующих контекстах

2. **Токенизация**:
   - Разделение слов на части (`O scar W ild e`)
   - Проблемы с обработкой заглавных букв

3. **Контроль длины**:
   - Модель не всегда соблюдает ограничения на длину ответа

## Заключение

Проект успешно реализует базовые требования задания. Основные компоненты (архитектура трансформера, токенизация, обучение) работают корректно. Качество генерации требует дополнительной доработки, особенно в части:

- соблюдения контекста
- контроля стилистики
- точного следования инструкциям

Для практического использования рекомендуется реализовать предложенные улучшения.